---
title: "Multiple Regression Analysis"
author: "Thomas Sun"
date: "Friday, October 14, 2016"
output: html_document
---

## Abstract

This report attempts to reproduce the results found in Chapter 3 Section 3.2 of the book **An Introduction to Statistical Learning**. In this section, a multiple regression analysis is run on the *Advertising* dataset, containing data on sales and advertising budget for a particular product. Using a multiple linear regression model and a simple linear regression model for each type of advertising, I find the same estimates of the coefficients, obtain the same quality index results, and similar looking plots as the ones contained in the book.

## Introduction

The goal is to determine whether there is an effect of advertising on sales, ideally to increase product sales. Specifically, if increasing spending on certain mediums of advertising has a relationship with the amount of sales on a product. This section is concerned with three specific mediums of advertising, `TV`, `Radio`, and `Newspaper`. Then it fits three separate simple regression models to each of them with `Sales`, and finally a multiple regression model including all three. When comparing the three regressors individually in the simple regression case, it finds that `Newspaper` has the strongest effect on `Sales`, followed by `Radio` and `TV`. Meanwhile, when the three are fit together in multiple regression, it finds that `Radio` has the strongest relationship with `Sales`, followed by `TV` while `Newspaper` has almost no relationship.


## Data

Data was obtained by downloading the *Advertising* dataset available on the textbook's website. It contains data of the size of advertising budget for `TV`, `Radio`, and `Newspaper` (in thousands of dollars) for a product in 200 different markets, in addition to the number of sales (in thousands of units) for the product in each market.

In the textbook, the authors' provide their calculated regression statistics and fit measures for each simple and multiple regression analysis that they perform on the *Advertising* dataset, as well as relevant scatterplots.

## Methodology

In order to find the relationship between `Sales` on `TV`, `Radio`, and `Newspaper`, a simple linear model is used for each predictor.

$Sales = \beta{0} + \beta{1}*Predictor + \epsilon$

In addition, we use a multiple linear model to find the relationship for all three predictors.

$Sales = \beta{0} + \beta{1}*TV + \beta{2}*Radio + \beta{3}*Newspaper + \epsilon$

Where $\beta{0}$ is the intercept, $\beta{1}$, $\beta{2}$, and $\beta{3}$ are the regression coefficients for their associated predictor. To find an estimate for these coefficients, we use the ordinary least squares method to fit the model. OLS regression was run through RStudio, where the regression coefficients and quality indices (mean squared error, R-squared, F-statistic) are calculated.

## Results

The estimated coefficients for all three simple regressions were calculated and found on the following tables.

```{r, echo=FALSE, warning=FALSE, results = "asis"}
library(xtable)
load(file="../data/regression.RData")

tab <- xtable(regressionTV_summary, 
              digits = 3, 
              caption = "Simple Regression of Sales on TV",
              align = c("c","c","c","c","c")
              )
print(tab, type="html", caption.placement = "top")

```

```{r, echo=FALSE, warning=FALSE, results = "asis"}
library(xtable)
load(file="../data/regression.RData")

tab <- xtable(regressionRadio_summary, 
              digits = 3, 
              caption = "Simple Regression of Sales on Radio",
              align = c("c","c","c","c","c")
              )
print(tab, type="html", caption.placement = "top")

```

```{r, echo=FALSE, warning=FALSE, results = "asis"}
library(xtable)
load(file="../data/regression.RData")

tab <- xtable(regressionNewspaper_summary, 
              digits = 3, 
              caption = "Simple Regression of Sales on Newspaper",
              align = c("c","c","c","c","c")
              )
print(tab, type="html", caption.placement = "top")

```



```{r, echo=FALSE, warning=FALSE, results = "asis"}
library(xtable)
load(file="../data/regression.RData")

tab <- xtable(regression_summary, 
              digits = 3, 
              caption = "Multiple of Sales on TV, Radio, and Newspaper",
              align = c("c","c","c","c","c")
              )
print(tab, type="html", caption.placement = "top")

```

```{r, echo=FALSE, warning=FALSE, results = "asis"}
library(xtable)
load(file="../data/correlation-matrix.RData")

tab <- xtable(corr_matrix,
              digits = 3,
              caption = 'Correlation Matrix',
              align = c("c","c","c","c","c")
              )
print(tab, type="html", caption.placement = "top")

```

```{r, echo=FALSE, warning=FALSE, results = "asis"}
library(xtable)
load(file="../data/regression.RData")
source(file="../code/functions/regression-functions.R")

tab <- matrix(c(residual_std_error(regression), r_squared(regression), f_statistic(regression)),
              c(3,1))

rownames(tab) <- c("MSE", "$R^2$", "F-Stat")
colnames(tab) <- "Value"

tab <- xtable(tab, 
              digits = 3,
              caption = "Quality Indices",
              align = c("c","c")
              )
print(tab, type="html", caption.placement = "top")

```

## Conclusions

Using a multiple linear regression, I successfully managed to reproduce the regression analysis and results found in the textbook. The values for the estimated coefficients and quality indices are exactly the same. These results suggest that increasing TV advertising budget means the number of sales for the product will also increase. The regression coefficients appear they can be useful in predicting sales for a given amount of TV advertising. According to the regression line, for every additional unit of TV advertising, sales of the product will increase by .05 units.

However, based on the scatterplot, points seem to increase in variance as sales increases. This violates the simple linear regression assumption that the variables are homoskedastic, which weakens the efficiency of the estimators. This means that variance in the estimators are likely to be larger and the calculated standard errors are likely biased. A more robust analysis can be performed to account for heteroskedasticity.

Additionally, when TV advertising is near zero, the data points seems to fall below the regression line. A non-linear model, such as a square root curve, may fit better.
